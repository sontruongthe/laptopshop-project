<!DOCTYPE html>
<html
  lang="en"
  xmlns:th="http://www.thymeleaf.org"
  xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
  layout:decorate="~{Usersform/layoutSite.html}"
>
  <head>
    <style>
      /* CSS cho ul (search bar) */
      ul.search-bar {
        float: right; /* ƒê·∫©y sang ph·∫£i */
        margin-top: 17px; /* Kho·∫£ng c√°ch tr√™n */
        width: 30%; /* Chi·ªÅu r·ªông */
        list-style: none; /* B·ªè d·∫•u ƒë·∫ßu d√≤ng */
        padding: 0;
        display: block; /* Duy tr√¨ l√† kh·ªëi */
      }

      /* CSS cho input (search bar) */
      ul.search-bar input[type="text"] {
        width: 100%; /* ƒê·∫ßy chi·ªÅu r·ªông ul */
        padding: 10px; /* Kho·∫£ng c√°ch b√™n trong */
        border: 1px solid #ccc; /* Vi·ªÅn nh·∫°t */
        border-radius: 25px; /* Bo tr√≤n g√≥c m·∫°nh h∆°n */
        font-size: 14px; /* K√≠ch th∆∞·ªõc ch·ªØ */
        outline: none; /* B·ªè vi·ªÅn m·∫∑c ƒë·ªãnh khi focus */
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1); /* Hi·ªáu ·ª©ng b√≥ng */
        transition: all 0.3s ease; /* Hi·ªáu ·ª©ng hover */
      }

      /* Hi·ªáu ·ª©ng khi input focus */
      ul.search-bar input[type="text"]:focus {
        border-color: #007bff; /* ƒê·ªïi m√†u vi·ªÅn */
        box-shadow: 0 4px 8px rgba(0, 123, 255, 0.2); /* Hi·ªáu ·ª©ng b√≥ng m·∫°nh h∆°n */
      }
      #chatbox-toggle {
  position: fixed;
  bottom: 20px;
  right: 25px;
  background: #007bff;
  color: white;
  border-radius: 50%;
  padding: 12px;
  font-size: 20px;
  cursor: pointer;
  z-index: 1000;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
}

#chatbox-container {
  position: fixed;
  bottom: 80px;
  right: 25px;
  width: 300px;
  max-height: 400px;
  background: white;
  border: 1px solid #ccc;
  border-radius: 10px;
  display: none;
  flex-direction: column;
  z-index: 999;
  box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
}

#chatbox-header {
  background: #007bff;
  color: white;
  padding: 10px;
  font-weight: bold;
  border-top-left-radius: 10px;
  border-top-right-radius: 10px;
}

#chatbox-messages {
  padding: 10px;
  height: 250px;
  overflow-y: auto;
  font-size: 14px;
  border-bottom: 1px solid #ccc;
}

#chatbox-input {
  width: 100%;
  border: none;
  padding: 10px;
  border-radius: 0 0 10px 10px;
  font-size: 14px;
  box-sizing: border-box;
  outline: none;
}


    </style>

  </head>

  <body>
    <div id="chatbox-toggle" onclick="toggleChatbox()">üí¨</div>
<div id="chatbox-container">
  <div id="chatbox-header">AI Chat <span onclick="toggleChatbox()" style="float:right; cursor:pointer;">‚úñ</span></div>
  <div id="chatbox-messages"></div>
  <input type="text" id="chatbox-input" placeholder="Type a message..." onkeypress="handleChatKey(event)">
</div>

    <section
      class="htc__product__area shop__page  bg__white"
      layout:fragment="content"
    >
      <div class="container" ng-controller="ctrlHome">
        <div class="htc__product__container">
          <!-- Start Product MEnu -->
          <div class="row">
            <div class="col-md-12">
              <div class="filter__menu__container">
                <ul class="search-bar">
                  <input
                          type="text"
                          ng-model="name"
                          class="form-control"
                          placeholder="Search Here"
                  />
                </ul>

                <div style="font-size: larger">
                  <nav class="mainmenu__nav hidden-xs hidden-sm">
                    <ul class="main__menu">
                      <li style="cursor: pointer" class="drop"><a ng-click="load_all()">All</a></li>
                      <li style="cursor: pointer" class="drop">
                        <a>Categories</a>
                        <ul class="dropdown">
                          <li style="cursor: pointer"
                            ng-repeat="i in itemcate"
                            ng-click="productincate(i.categoryID)"
                          >
                            <a>{{i.name}} </a>
                          </li>
                        </ul>
                      </li>
                    </ul>
                  </nav>
                </div>
              </div>
            </div>
          </div>
          <!-- Start Filter Menu -->

          <!-- End Filter Menu -->
          <!-- End Product MEnu -->
          <div class="row">
            <div class="product__list another-product-style">
              <div
                class="col-md-3 single__pro col-lg-3 col-sm-4 col-xs-12 cat--3"
                style="
                  display: block;
                  max-width: 300px;
                  max-height: 440px;
                  width: 300px;
                  height: 440px;
                "
                ng-repeat="item in page.items | filter:name"
              >
                <div class="product">
                  <div class="product__inner">
                    <div class="pro__thumb">
                      <a style="display: block">
                        <img
                          ng-src="{{'https://firebasestorage.googleapis.com/v0/b/uploadimagesjava6.appspot.com/o/'+item.image+ '?alt=media&token=155d6665-5e02-42e7-9b7b-f22eb82799fa'}}"
                          style="
                            display: block;
                            max-width: 270px;
                            max-height: 270px;
                            width: 270px;
                            height: 270px;
                          "
                          alt="product images"
                          class="img-fluid ${3|rounded-top,rounded-right,rounded-bottom,rounded-left,rounded-circle,|}"
                        />
                      </a>
                    </div>
                    <th:block th:if="${#request.isUserInRole('USER')}">
                      <div class="product__hover__info">
                        <span class="hidden" id="username"
                          >[[${#request.remoteUser}]]</span
                        >
                        <ul class="product__action">
                          <li>
                            <a
                              data-toggle="modal"
                              data-target="#productModal"
                              ng-click="views(item.productID)"
                              title="Quick View"
                              class="quick-view modal-view detail-link"
                              ><span class="ti-plus"></span
                            ></a>
                          </li>
                          <li>
                            <a
                              title="Add TO Cart"
                              th:attr="ng-click=@{|cart.add(item.productID)|}"
                              ><span class="ti-shopping-cart"></span
                            ></a>
                          </li>
                          <li>
                            <a title="Wishlist" href="/wishlist"
                              ><span class="ti-heart"></span
                            ></a>
                          </li>
                        </ul>
                      </div>
                    </th:block>
                    <th:block th:unless="${#request.isUserInRole('USER')}">
                      <div class="product__hover__info">
                        <ul class="product__action" style="color: red">
                          <a href="/auth/login/form">Ch∆∞a ƒêƒÉng Nh·∫≠p</a>
                        </ul>
                      </div>
                    </th:block>
                  </div>
                  <div class="product__details">
                    <h2><a>{{item.name}}</a></h2>
                    <ul class="product__price">
                      <li class="old__price" ng-if="item.discount!=0">
                        {{item.unitPrice | currency:"":0}} VND
                      </li>
                      <li class="new__price">
                        {{getAmount(item.unitPrice,item.discount) |
                        currency:"":0}} VND
                      </li>
                    </ul>
                  </div>
                </div>
              </div>

              <!-- End Single Product -->
            </div>
          </div>
          <!-- Start Load More BTn -->
          <div class="row mt--60">
            <div class="col-md-12">
              <div class="htc__loadmore__btn">
                <a ng-click="page.loadmore()">load more</a>
              </div>
            </div>
          </div>
          <!-- Modal -->
          <div class="modal fade" id="productModal" tabindex="-1" role="dialog">
            <div class="modal-dialog modal__container" role="document">
              <div class="modal-content">
                <div class="modal-header">
                  <button
                    type="button"
                    class="close"
                    data-dismiss="modal"
                    aria-label="Close"
                  >
                    <span aria-hidden="true">&times;</span>
                  </button>
                </div>
                <div class="modal-body">
                  <form>
                    <div class="modal-product">
                      <!-- Start product images -->
                      <div class="product-images">
                        <div class="main-image images">
                          <img
                            alt="big images"
                            ng-src="{{'https://firebasestorage.googleapis.com/v0/b/uploadimagesjava6.appspot.com/o/'+show.image + '?alt=media&token=155d6665-5e02-42e7-9b7b-f22eb82799fa'}}"
                            class="img-fluid ${3|rounded-top,rounded-right,rounded-bottom,rounded-left,rounded-circle,|}"
                            style="
                              display: block;
                              max-width: 600px;
                              max-height: 600px;
                              width: 600px;
                              height: 600px;
                            "
                          />
                        </div>
                      </div>
                      <!-- end product images -->
                      <div class="product-info">
                        <h1>{{show.name}}</h1>
                        <div class="rating__and__review">
                          <ul class="rating">
                            <li><span class="ti-star"></span></li>
                            <li><span class="ti-star"></span></li>
                            <li><span class="ti-star"></span></li>
                            <li><span class="ti-star"></span></li>
                            <li><span class="ti-star"></span></li>
                          </ul>
                          <div class="review">
                            <a href="#">4 customer reviews</a>
                          </div>
                        </div>
                        <div class="price-box-3">
                          <div class="s-price-box">
                            <span class="new-price"
                              >{{getAmount(show.unitPrice,show.discount) |
                              currency:"":0}} VND</span
                            >
                            <span class="old-price"
                              >{{show.unitPrice | currency:"":0}} VND</span
                            >
                          </div>
                        </div>
                        <div class="quick-desc">{{show.description}}</div>

                        <div class="social-sharing">
                          <div class="widget widget_socialsharing_widget">
                            <h3 class="widget-title-modal">
                              Share this product
                            </h3>
                            <ul class="social-icons">
                              <li>
                                <a
                                  target="_blank"
                                  title="rss"
                                  href="#"
                                  class="rss social-icon"
                                  ><i class="zmdi zmdi-rss"></i
                                ></a>
                              </li>
                              <li>
                                <a
                                  target="_blank"
                                  title="Linkedin"
                                  href="#"
                                  class="linkedin social-icon"
                                  ><i class="zmdi zmdi-linkedin"></i
                                ></a>
                              </li>
                              <li>
                                <a
                                  target="_blank"
                                  title="Pinterest"
                                  href="#"
                                  class="pinterest social-icon"
                                  ><i class="zmdi zmdi-pinterest"></i
                                ></a>
                              </li>
                              <li>
                                <a
                                  target="_blank"
                                  title="Tumblr"
                                  href="#"
                                  class="tumblr social-icon"
                                  ><i class="zmdi zmdi-tumblr"></i
                                ></a>
                              </li>
                              <li>
                                <a
                                  target="_blank"
                                  title="Pinterest"
                                  href="#"
                                  class="pinterest social-icon"
                                  ><i class="zmdi zmdi-pinterest"></i
                                ></a>
                              </li>
                            </ul>
                          </div>
                        </div>
                        <div class="addtocart-btn">
                          <a th:attr="ng-click=@{|cart.add(show.productID)|}"
                            >Add to cart</a
                          >
                        </div>
                      </div>
                      <!-- .product-info -->
                    </div>
                    <!-- .modal-product -->
                  </form>
                </div>
                <!-- .modal-body -->
              </div>
              <!-- .modal-content -->
            </div>
            <!-- .modal-dialog -->
          </div>
          <!-- END Modal -->
        </div>
      </div>
    </section>
    <script>
      function toggleChatbox() {
        const box = document.getElementById("chatbox-container");
        box.style.display = box.style.display === "flex" ? "none" : "flex";
      }
    
      function handleChatKey(e) {
        if (e.key === "Enter") {
          const input = document.getElementById("chatbox-input");
          const message = input.value.trim();
          if (message === "") return;
    
          const chat = document.getElementById("chatbox-messages");
          chat.innerHTML += `<div><strong>You:</strong> ${message}</div>`;
    
          // üëá ƒê√¢y l√† n∆°i b·∫°n k·∫øt n·ªëi API ho·∫∑c x·ª≠ l√Ω tr·∫£ l·ªùi t·ª± ƒë·ªông
          chat.innerHTML += `<div><strong>Bot:</strong> ${simulateResponse(message)}</div>`;
          input.value = "";
          chat.scrollTop = chat.scrollHeight;
        }
      }
    
      function simulateResponse(msg) {
        // ƒê√¢y l√† m√¥ ph·ªèng ph·∫£n h·ªìi, b·∫°n c√≥ th·ªÉ thay b·∫±ng g·ªçi API th·ª±c t·∫ø
        return "B·∫°n v·ª´a n√≥i: " + msg;
      }
    </script>
    
  </body>
</html>
